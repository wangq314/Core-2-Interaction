<html>

<head>
    <title>Collection of Frisbee Discs</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/peterhry/CircleType@2.3.1/dist/circletype.min.js"></script>
    <meta charset="utf-8" />
    <title>Collection of Frisbee Discs</title>
    <link rel="stylesheet" href="homepage.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC&display=swap" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/gill-sans-std" rel="stylesheet">
</head>

<body>
    <div class="container"><a href="/Users/criswang/Desktop/Core 2 Interaction/Project 2/mode2.html">
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
            <div class="disc">COLLECTION OF FRISBEE DISCS</div>
        </a></div>

    <div id="disc-container">
        <div id="next-disc-preview-container" class="image-container">
            <img id="nextDiscImage" class="image" width="300px" alt="Image" />
        </div>
        <div id="throwing-disc-container" class="image-container">
            <img id="discImage" class="image" src="Frisbee disc/1-1.png" width="300px" alt="Image" />
            <div class="disc-title">
                <h3>Meow</h3>
            </div>
        </div>
    </div>

    <button id="hand-button" onclick="handleFrisbee()"><img id="hand-image" class="hand"
            src="/Users/criswang/Desktop/Core 2 Interaction/Project 2/Hand/1.png">
    </button>

</body>
<script>
    const idleHand = "/Users/criswang/Desktop/Core 2 Interaction/Project 2/Hand/1.png";
    const throwHand = "/Users/criswang/Desktop/Core 2 Interaction/Project 2/Hand/3.png";
    const discs = [
        { filename: '1-1', name: 'fun disc!!!' },
        { filename: '1-2', name: 'fun disc!!!' },
        { filename: '1-3', name: 'fun disc!!!' },
        { filename: '2-1', name: 'fun disc!!!' }
    ];
    let currentIndex = 0;
    let nextIndex = 1;

    let animation = anime({
        targets: '#throwing-disc-container',
        translateX: {
            value: 750,
            duration: 800
        },
        rotate: {
            value: 360,
            duration: 1800,
            easing: 'easeInOutSine'
        },
        scale: {
            value: 2,
            duration: 1600,
            delay: 800,
            easing: 'easeInOutQuart'
        },
        begin: startAnimation,
        complete: completeAnimation,
        delay: 250,
    });

    (function initPage() {
        updateBackupDisc()
        currentIndex = nextIndex
        nextIndex += 1
    })()

    function shuffleDiscs() {
        for (let i = discs.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [discs[i], discs[j]] = [discs[j], discs[i]];
        }
    }
    let currentTimeout;

    function resetHand() {
        document.querySelector('#hand-image').src = idleHand
    }

    function startAnimation() {
        clearTimeout(currentTimeout)
        resetHand()
        currentTimeout = setTimeout(() => {
            document.querySelector('#hand-image').src = throwHand;
        }, 200)
        document.querySelector('.disc-title').style = 'visibility: hidden';
    }


    function completeAnimation() {
        resetHand()
        document.querySelector('.disc-title').style = 'visibility: visible';
        document.querySelector('.disc-title').textContent = discs[currentIndex].name;

    }

    function updateBackupDisc() {
        let randomDisc = discs[nextIndex].filename
        let imagePath = `./Frisbee disc/${randomDisc}.png`;
        document.querySelector('#nextDiscImage').src = imagePath
        document.querySelector('#next-disc-preview-container').style = 'display:block'
    }

    function handleFrisbee() {
        if (nextIndex >= discs.length) {
            shuffleDiscs()
            nextIndex = 0
        }
        updateBackupDisc()

        let randomDisc = discs[currentIndex].filename
        let imagePath = `./Frisbee disc/${randomDisc}.png`;
        document.querySelector('#discImage').src = imagePath
        animation.restart()

        currentIndex = nextIndex
        nextIndex += 1
    }
</script>

</html>